{% extends "base.html" %}

{% block title %}Archive Server{% endblock %}
{% block page_title %}Mock Archive Server{% endblock %}

{% block header_actions %}
<button class="btn" id="btn-toggle" onclick="toggleArchive()">
    <span id="toggle-text">‚ñ∂ Start</span>
</button>
{% endblock %}

{% block content %}
<div class="settings-page">
    <div class="settings-grid">
        <!-- –î–∞–Ω–Ω—ã–µ -->
        <div class="card">
            <div class="card-header">
                <h3>üìä –î–∞–Ω–Ω—ã–µ</h3>
            </div>
            <div class="card-body">
                <div class="form-group">
                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞—Ç—á–∏–∫–æ–≤</label>
                    <input type="number" id="cfg-sensors" value="10" min="1" max="127">
                </div>
                <div class="form-group">
                    <label>–ì–ª—É–±–∏–Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏ (–¥–Ω–µ–π)</label>
                    <input type="number" id="cfg-days" value="30" min="1" max="365">
                </div>
                <div class="form-group">
                    <label>–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ (–º—Å)</label>
                    <input type="number" id="cfg-resolution" value="60000" min="1000" max="3600000">
                </div>
            </div>
        </div>
        
        <!-- –°–æ–±—ã—Ç–∏—è -->
        <div class="card">
            <div class="card-header">
                <h3>üîî –°–æ–±—ã—Ç–∏—è</h3>
            </div>
            <div class="card-body">
                <div class="checkbox-group">
                    <input type="checkbox" id="cfg-events" checked>
                    <label for="cfg-events">–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è</label>
                </div>
                <div class="form-group">
                    <label>–ß–∞—Å—Ç–æ—Ç–∞ —Å–æ–±—ã—Ç–∏–π</label>
                    <input type="range" id="cfg-event-freq" min="0" max="100" value="1"
                           oninput="document.getElementById('event-val').textContent = (this.value/100).toFixed(2)">
                    <span id="event-val">0.01</span>
                </div>
            </div>
        </div>
        
        <!-- –°—Ç–∞—Ç—É—Å -->
        <div class="card">
            <div class="card-header">
                <h3>üìà –°—Ç–∞—Ç—É—Å —Ö—Ä–∞–Ω–∏–ª–∏—â–∞</h3>
            </div>
            <div class="card-body">
                <div class="stat-row">
                    <span class="label">–ó–∞–ø–∏—Å–µ–π</span>
                    <span class="value" id="stat-records">0</span>
                </div>
                <div class="stat-row">
                    <span class="label">–°–æ–±—ã—Ç–∏–π</span>
                    <span class="value" id="stat-events">0</span>
                </div>
                <div class="stat-row">
                    <span class="label">–ù–µ–∫–≤–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö</span>
                    <span class="value" id="stat-unack">0</span>
                </div>
                <div class="stat-row">
                    <span class="label">–ü–∞–º—è—Ç—å</span>
                    <span class="value" id="stat-memory">0 MB</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∏ -->
    <div class="actions-bar">
        <button class="btn btn-primary" onclick="saveConfig()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <button class="btn" onclick="loadConfig()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
        <button class="btn btn-danger" onclick="regenerateData()">üîÑ –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>
    
    <!-- –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å -->
    <div class="card">
        <div class="card-header">
            <h3>üîç –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å</h3>
        </div>
        <div class="card-body">
            <div class="form-row">
                <div class="form-group">
                    <label>–î–∞—Ç—á–∏–∫ ID</label>
                    <input type="number" id="query-sensor" value="1" min="1">
                </div>
                <div class="form-group">
                    <label>–ü–µ—Ä–∏–æ–¥ (—á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥)</label>
                    <input type="number" id="query-hours" value="24" min="1">
                </div>
                <div class="form-group">
                    <label>–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ</label>
                    <select id="query-resolution">
                        <option value="minute">–ú–∏–Ω—É—Ç—ã</option>
                        <option value="hour" selected>–ß–∞—Å—ã</option>
                        <option value="day">–î–Ω–∏</option>
                    </select>
                </div>
            </div>
            <button class="btn" onclick="queryData()">üîç –ó–∞–ø—Ä–æ—Å–∏—Ç—å</button>
        </div>
    </div>
    
    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ -->
    <div class="card">
        <div class="card-header">
            <h3>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞</h3>
        </div>
        <div class="card-body">
            <pre class="json-preview" id="query-result">–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å...</pre>
        </div>
    </div>
    
    <!-- –°–æ–±—ã—Ç–∏—è -->
    <div class="card">
        <div class="card-header">
            <h3>üîî –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è</h3>
            <button class="btn btn-sm" onclick="refreshEvents()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
        </div>
        <div class="card-body">
            <table class="data-table" id="events-table">
                <thead>
                    <tr>
                        <th>–í—Ä–µ–º—è</th>
                        <th>–î–∞—Ç—á–∏–∫</th>
                        <th>–¢–∏–ø</th>
                        <th>–ó–Ω–∞—á–µ–Ω–∏–µ</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td colspan="5" class="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/archive.js') }}"></script>
{% endblock %}
